---
import fs from "fs";
import Layout from "../layouts/Layout.astro";
export function getStaticPaths() {
    return fs.readdirSync("public/swfs").map(file => {
        return {params: {swf: file, name: Math.random()}};
    });
}
const {swf, name} = Astro.params;
declare const window: Window & {
    RufflePlayer?: Partial<{
        newest: () => {
            createPlayer: () => any;
        };
        config: {
            publicPath: string;
        };
    }>;
};
---

<script src="/swf-port/ruffle/ruffle.js" is:inline></script>
<script>
    window.RufflePlayer = window.RufflePlayer || {};
    window.RufflePlayer.config = {publicPath: "/swf-port/ruffle/"};
    window.addEventListener("load", event => {
        const ruffle = window.RufflePlayer.newest();
        const player = ruffle.createPlayer();
        const container = document.getElementById("swf-container");
        container.appendChild(player);
        player.load(`/swf-port/swfs/${container.dataset.href}`);
    });
</script>
<Layout title={name}>
    <div id="swf-container" data-href={swf}></div>
</Layout>
